<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Hello, World! • A-Frame</title>
        <meta name="description" content="Hello, World! • A-Frame">
        <script src="../aframe-master/dist/aframe-v1.0.3.js"></script>
        <script src="../AR.js-master/aframe/build/aframe-ar.js"></script>
        <!-- <script src="../AR.js-master/three.js/build/ar.js"></script>         -->
    </head>
  <body>
    <script>      
        AFRAME.registerComponent('hide-on-enter-vr-click', {
        schema: {type: 'selector'},
    
        init: function () {
            var element = this.data;
            var button = this.el.querySelector('.a-enter-vr-button');
            button.addEventListener('click', function () {
            element.style.opacity = 0;
            });
            }
        });
        AFRAME.registerComponent('screenshot', {
            init: function() {
                console.log('blub');

                var image = document.querySelector("a-scene").components.screenshot.capture('perspective');

                image.addEventListener("load", function () {
                    var imgCanvas = document.createElement("canvas"),
                    imgContext = imgCanvas.getContext("2d");

                    // Make sure canvas is as big as the picture
                    imgCanvas.width = image.width;
                    imgCanvas.height = image.height;

                    // Draw image into canvas element
                    imgContext.drawImage(image, 0, 0, image.width, image.height);

                    // Get canvas contents as a data URL
                    var imgAsDataURL = imgCanvas.toDataURL("image/png");

                    localStorage.setItem("image", imgAsDataURL);
                            // var image = new Image(200, 200);
                            // Fil
                            // image.name = "image.png";
                            // image.src = document.querySelector("a-scene").components.screenshot.capture('perspective');
                            // document.appendChild
                }
                }
            });
    </script>


    <div>
        <a-scene embedded ar renderer="maxCanvasWidth: 20; maxCanvasHeight: 20;">
        <a-camera></a-camera>
        <a-assets>
            <a-asset id="sunflower" src="../media/gltf/sunflower/sunflower.gltf"></a-asset>
            <figure>
                <img id="image" src="about:blank">
                    <noscript>
                        <img src="image.png">
                    </noscript>    
            </figure>
        </a-assets>
        <a-entity id="flower" gltf-model="#sunflower" position="0 0 -5" scale="2 2 2">
        <a-ring id="cursor" color="teal" radius-inner="0.02" radius-outer="0.03" position="0 -3 -3" rotation="-90 0 0"></a-ring>
        </a-scene>
    </div>


  </body>
</html>